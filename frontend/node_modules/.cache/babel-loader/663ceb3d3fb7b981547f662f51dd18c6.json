{"ast":null,"code":"import _slicedToArray from\"D:/Web Development/woodsy/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"D:/Web Development/woodsy/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"D:/Web Development/woodsy/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useReducer}from\"react\";import CartContext from\"./cart-context\";import{jsx as _jsx}from\"react/jsx-runtime\";var defaultCartState={products:[],totalAmount:0};var saveCartOnLocal=function saveCartOnLocal(cartState){localStorage.setItem(\"cartState\",JSON.stringify(cartState));};var getLocalCartState=function getLocalCartState(){var state=JSON.parse(localStorage.getItem(\"cartState\"));if(state)return _objectSpread(_objectSpread({},state),{},{totalAmount:+state.totalAmount});};var cartReducer=function cartReducer(state,action){if(action.type===\"ADD\"){var currProduct=action.payload;var updatedTotalAmount=state.totalAmount+currProduct.price*currProduct.amount;console.log(updatedTotalAmount);var existingCartProductIndex=state.products.findIndex(function(product){return product._id===currProduct._id;});var existingCartProduct=state.products[existingCartProductIndex];var updatedProducts;if(existingCartProduct){var updatedProduct=_objectSpread(_objectSpread({},existingCartProduct),{},{amount:existingCartProduct.amount+currProduct.amount});updatedProducts=_toConsumableArray(state.products);updatedProducts[existingCartProductIndex]=updatedProduct;}else{updatedProducts=state.products.concat(currProduct);}var cartState={products:updatedProducts,totalAmount:Math.round((updatedTotalAmount+Number.EPSILON)*100)/100};saveCartOnLocal(cartState);return cartState;}if(action.type===\"REMOVE\"){var currProductId=action.payload;var _existingCartProductIndex=state.products.findIndex(function(product){return product._id===currProductId;});var _existingCartProduct=state.products[_existingCartProductIndex];var _updatedTotalAmount=state.totalAmount-_existingCartProduct.price;var _updatedProducts;if(_existingCartProduct.amount===1){_updatedProducts=state.products.filter(function(product){return product._id!==currProductId;});}else{var _updatedProduct=_objectSpread(_objectSpread({},_existingCartProduct),{},{amount:_existingCartProduct.amount-1});_updatedProducts=_toConsumableArray(state.products);_updatedProducts[_existingCartProductIndex]=_updatedProduct;}var _cartState={products:_updatedProducts,totalAmount:Math.round((_updatedTotalAmount+Number.EPSILON)*100)/100};saveCartOnLocal(_cartState);return _cartState;}if(action.type===\"REMOVE_ITEM\"){var _currProductId=action.payload;var _updatedProducts2=state.products.filter(function(product){return product._id!==_currProductId;});var _existingCartProductIndex2=state.products.findIndex(function(product){return product._id===_currProductId;});var _existingCartProduct2=state.products[_existingCartProductIndex2];var _updatedTotalAmount2=state.totalAmount-_existingCartProduct2.price*_existingCartProduct2.amount;var _cartState2={products:_updatedProducts2,totalAmount:Math.round((_updatedTotalAmount2+Number.EPSILON)*100)/100};saveCartOnLocal(_cartState2);return _cartState2;}return getLocalCartState()?getLocalCartState():defaultCartState;};var CartProvider=function CartProvider(props){var _useReducer=useReducer(cartReducer,getLocalCartState()?getLocalCartState():defaultCartState),_useReducer2=_slicedToArray(_useReducer,2),cartState=_useReducer2[0],dispatchCartAction=_useReducer2[1];console.log(cartState);var addProductToCartHandler=function addProductToCartHandler(product){dispatchCartAction({type:\"ADD\",payload:product});};var removeProductFromCartHandler=function removeProductFromCartHandler(productId){dispatchCartAction({type:\"REMOVE\",payload:productId});};var clearProductFromCart=function clearProductFromCart(productId){dispatchCartAction({type:\"REMOVE_ITEM\",payload:productId});};var cartContext={products:cartState.products,totalAmount:cartState.totalAmount,addProduct:addProductToCartHandler,removeProduct:removeProductFromCartHandler,clearProduct:clearProductFromCart};return/*#__PURE__*/_jsx(CartContext.Provider,{value:cartContext,children:props.children});};export default CartProvider;","map":{"version":3,"sources":["D:/Web Development/woodsy/frontend/src/context/CartProvider.js"],"names":["React","useReducer","CartContext","defaultCartState","products","totalAmount","saveCartOnLocal","cartState","localStorage","setItem","JSON","stringify","getLocalCartState","state","parse","getItem","cartReducer","action","type","currProduct","payload","updatedTotalAmount","price","amount","console","log","existingCartProductIndex","findIndex","product","_id","existingCartProduct","updatedProducts","updatedProduct","concat","Math","round","Number","EPSILON","currProductId","filter","CartProvider","props","dispatchCartAction","addProductToCartHandler","removeProductFromCartHandler","productId","clearProductFromCart","cartContext","addProduct","removeProduct","clearProduct","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from \"react\";\r\nimport CartContext from \"./cart-context\";\r\n\r\nconst defaultCartState = {\r\n  products: [],\r\n  totalAmount: 0,\r\n};\r\n\r\nconst saveCartOnLocal = (cartState) => {\r\n  localStorage.setItem(\"cartState\", JSON.stringify(cartState));\r\n};\r\n\r\nconst getLocalCartState = () => {\r\n  const state = JSON.parse(localStorage.getItem(\"cartState\"));\r\n  if (state) return { ...state, totalAmount: +state.totalAmount };\r\n};\r\n\r\nconst cartReducer = (state, action) => {\r\n  if (action.type === \"ADD\") {\r\n    const currProduct = action.payload;\r\n    const updatedTotalAmount =\r\n      state.totalAmount + currProduct.price * currProduct.amount;\r\n\r\n    console.log(updatedTotalAmount);\r\n\r\n    const existingCartProductIndex = state.products.findIndex(\r\n      (product) => product._id === currProduct._id\r\n    );\r\n    const existingCartProduct = state.products[existingCartProductIndex];\r\n\r\n    let updatedProducts;\r\n    if (existingCartProduct) {\r\n      const updatedProduct = {\r\n        ...existingCartProduct,\r\n        amount: existingCartProduct.amount + currProduct.amount,\r\n      };\r\n      updatedProducts = [...state.products];\r\n      updatedProducts[existingCartProductIndex] = updatedProduct;\r\n    } else {\r\n      updatedProducts = state.products.concat(currProduct);\r\n    }\r\n\r\n    const cartState = {\r\n      products: updatedProducts,\r\n      totalAmount: Math.round((updatedTotalAmount + Number.EPSILON) * 100) / 100,\r\n    };\r\n\r\n    saveCartOnLocal(cartState);\r\n    return cartState;\r\n  }\r\n\r\n  if (action.type === \"REMOVE\") {\r\n    const currProductId = action.payload;\r\n    const existingCartProductIndex = state.products.findIndex(\r\n      (product) => product._id === currProductId\r\n    );\r\n    const existingCartProduct = state.products[existingCartProductIndex];\r\n    const updatedTotalAmount = state.totalAmount - existingCartProduct.price;\r\n\r\n    let updatedProducts;\r\n    if (existingCartProduct.amount === 1) {\r\n      updatedProducts = state.products.filter(\r\n        (product) => product._id !== currProductId\r\n      );\r\n    } else {\r\n      const updatedProduct = {\r\n        ...existingCartProduct,\r\n        amount: existingCartProduct.amount - 1,\r\n      };\r\n      updatedProducts = [...state.products];\r\n      updatedProducts[existingCartProductIndex] = updatedProduct;\r\n    }\r\n\r\n    const cartState = {\r\n      products: updatedProducts,\r\n      totalAmount: Math.round((updatedTotalAmount + Number.EPSILON) * 100) / 100,\r\n    };\r\n\r\n    saveCartOnLocal(cartState);\r\n    return cartState;\r\n  }\r\n\r\n  if (action.type === \"REMOVE_ITEM\") {\r\n    const currProductId = action.payload;\r\n    const updatedProducts = state.products.filter(\r\n      (product) => product._id !== currProductId\r\n    );\r\n    const existingCartProductIndex = state.products.findIndex(\r\n      (product) => product._id === currProductId\r\n    );\r\n    const existingCartProduct = state.products[existingCartProductIndex];\r\n    const updatedTotalAmount =\r\n      state.totalAmount -\r\n      existingCartProduct.price * existingCartProduct.amount;\r\n\r\n    const cartState = {\r\n      products: updatedProducts,\r\n      totalAmount: Math.round((updatedTotalAmount + Number.EPSILON) * 100) / 100,\r\n    };\r\n\r\n    saveCartOnLocal(cartState);\r\n    return cartState;\r\n  }\r\n\r\n  return getLocalCartState() ? getLocalCartState() : defaultCartState;\r\n};\r\n\r\nconst CartProvider = (props) => {\r\n  const [cartState, dispatchCartAction] = useReducer(\r\n    cartReducer,\r\n    getLocalCartState() ? getLocalCartState() : defaultCartState\r\n  );\r\n\r\n  console.log(cartState);\r\n\r\n  const addProductToCartHandler = (product) => {\r\n    dispatchCartAction({\r\n      type: \"ADD\",\r\n      payload: product,\r\n    });\r\n  };\r\n\r\n  const removeProductFromCartHandler = (productId) => {\r\n    dispatchCartAction({\r\n      type: \"REMOVE\",\r\n      payload: productId,\r\n    });\r\n  };\r\n\r\n  const clearProductFromCart = (productId) => {\r\n    dispatchCartAction({\r\n      type: \"REMOVE_ITEM\",\r\n      payload: productId,\r\n    });\r\n  };\r\n\r\n  const cartContext = {\r\n    products: cartState.products,\r\n    totalAmount: cartState.totalAmount,\r\n    addProduct: addProductToCartHandler,\r\n    removeProduct: removeProductFromCartHandler,\r\n    clearProduct: clearProductFromCart,\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={cartContext}>\r\n      {props.children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n\r\nexport default CartProvider;\r\n"]},"metadata":{},"sourceType":"module"}